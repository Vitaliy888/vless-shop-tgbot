{% extends "base.html" %}
{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞–º–∏{% endblock %}
{% block content %}
<h1>–°–µ—Ä–≤–µ—Ä—ã –∏ —Ç–∞—Ä–∏—Ñ—ã</h1>

<div class="settings-container">
  <div class="settings-column-left" style="flex:1 1 100%;">
    <section class="settings-section">
      <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –•–æ—Å—Ç–∞–º–∏ (–°–µ—Ä–≤–µ—Ä–∞–º–∏)</h2>

      <div class="host-card">
        <h4>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ö–æ—Å—Ç</h4>
        <form action="{{ url_for('add_host_route') }}" method="post">
          <div class="form-group">
            <label for="host_name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ö–æ—Å—Ç–∞:</label>
            <input type="text" id="host_name" name="host_name" required maxlength="128" />
          </div>
          <div class="form-group">
            <label for="host_url">URL –ø–∞–Ω–µ–ª–∏ XUI:</label>
            <input type="url" id="host_url" name="host_url" placeholder="http://123.45.67.89:54321" required />
          </div>
            <div class="form-group">
              <label for="host_username">–õ–æ–≥–∏–Ω XUI:</label>
              <input type="text" id="host_username" name="host_username" required />
            </div>
            <div class="form-group password-wrapper">
              <label for="host_pass">–ü–∞—Ä–æ–ª—å XUI:</label>
              <input type="password" id="host_pass" name="host_pass" required />
              <button type="button" class="toggle-password">üëÅÔ∏è</button>
            </div>
            <div class="form-group">
              <label for="host_inbound_id">ID –≤—Ö–æ–¥—è—â–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</label>
              <input type="number" id="host_inbound_id" name="host_inbound_id" required />
            </div>
            <div class="form-group">
              <label for="host_max_users">–ú–∞–∫—Å–∏–º—É–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø—É—Å—Ç–æ = –±–µ–∑ –ª–∏–º–∏—Ç–∞):</label>
              <input type="number" id="host_max_users" name="host_max_users" min="1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 100" />
            </div>
            <button type="submit" class="button button-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
        </form>
      </div>

      {% if hosts %}
        {% for host in hosts %}
          <div class="host-card">
            <div class="host-header">
              <h3>{{ host.host_name }}</h3>
              <form action="{{ url_for('delete_host_route', host_name=host.host_name) }}" method="post" data-confirm="–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ö–æ—Å—Ç –∏ –≤—Å–µ –µ–≥–æ —Ç–∞—Ä–∏—Ñ—ã?">
                <button type="submit" class="button button-danger button-small">–£–¥–∞–ª–∏—Ç—å</button>
              </form>
            </div>
            <p><strong>URL:</strong> {{ host.host_url }}</p>
            <p><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:</strong> {{ host.current_users or 0 }}{% if host.max_users %} / {{ host.max_users }}{% else %} (–±–µ–∑ –ª–∏–º–∏—Ç–∞){% endif %}</p>
            <div class="plans-section">
              <h4>–¢–∞—Ä–∏—Ñ—ã:</h4>
              {% if host.plans %}
                <ul class="plan-list">
                  {% for plan in host.plans %}
                    <li>
                      <span>{{ plan.plan_name }} - {{ plan.price|round(0) }} RUB</span>
                      <form action="{{ url_for('delete_plan_route', plan_id=plan.plan_id) }}" method="post">
                        <button type="submit" class="button button-danger button-tiny">√ó</button>
                      </form>
                    </li>
                  {% endfor %}
                </ul>
              {% else %}
                <p>–¢–∞—Ä–∏—Ñ—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.</p>
              {% endif %}
              <h5>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ:</h5>
              <form action="{{ url_for('add_plan_route') }}" method="post" class="form-inline">
                <input type="hidden" name="host_name" value="{{ host.host_name }}" />
                <input type="text" name="plan_name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required />
                <input type="number" name="months" placeholder="–ú–µ—Å." required />
                <input type="number" step="0.01" name="price" placeholder="–¶–µ–Ω–∞" required />
                <button type="submit" class="button button-primary button-small">+</button>
              </form>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p>–•–æ—Å—Ç—ã –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã.</p>
      {% endif %}
    </section>
  </div>
</div>

{% endblock %}